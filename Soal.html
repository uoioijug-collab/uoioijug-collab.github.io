<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ujian Online Sistem Komputer Kelas 10</title>
  <style>
    :root{
      --sky:#87CEEB; /* sky blue */
      --sky-deep:#5fb3e6;
      --primary:#0d6efd;
      --primary-dark:#0a58ca;
      --text:#1f2937;
      --muted:#6b7280;
      --card:#ffffff;
      --success:#16a34a;
      --danger:#dc2626;
      --warning:#f59e0b;
      --shadow:0 10px 25px rgba(0,0,0,.10);
      --radius:16px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family: "Segoe UI", system-ui, -apple-system, Roboto, Helvetica, Arial, sans-serif; color:var(--text);
      background: linear-gradient(180deg, var(--sky) 0%, #eaf6ff 60%);
      background-attachment: fixed;
    }

    .app{
      max-width: 1100px; margin: 24px auto; padding: 16px; 
    }

    /* Glass header */
    .navbar{
      display:flex; align-items:center; justify-content:space-between; gap:12px; 
      padding:14px 18px; border-radius: var(--radius);
      background: rgba(255,255,255,.75); backdrop-filter: blur(8px);
      box-shadow: var(--shadow);
    }
    .brand{display:flex; align-items:center; gap:12px}
    .logo{
      width:44px; height:44px; border-radius:12px; display:grid; place-items:center; font-weight:800; color:white;
      background: linear-gradient(135deg, var(--primary) 0%, var(--sky-deep) 100%);
      box-shadow: inset 0 0 10px rgba(255,255,255,.35);
    }
    h1{font-size: clamp(18px, 2.4vw, 24px); margin:0}
    .subtitle{font-size:12px; color:var(--muted)}

    .nav-actions{display:flex; gap:8px; flex-wrap:wrap}
    .btn{appearance:none; border:none; cursor:pointer; border-radius:12px; padding:10px 14px; font-weight:600; box-shadow:var(--shadow); transition: transform .05s ease, background .2s ease}
    .btn:active{transform: translateY(1px)}
    .btn-primary{background: var(--primary); color:white}
    .btn-primary:hover{background:var(--primary-dark)}
    .btn-ghost{background: rgba(255,255,255,.9)}
    .btn-danger{background:var(--danger); color:white}
    .btn-success{background:var(--success); color:white}
    .btn-print{background:var(--warning); color:white}

    .grid{display:grid; gap:18px}
    .grid-2{grid-template-columns: repeat(2, minmax(0,1fr))}
    @media (max-width: 900px){ .grid-2{grid-template-columns: 1fr} }

    .card{background:var(--card); border-radius: var(--radius); box-shadow: var(--shadow); padding:20px}
    .card h2{margin-top:0}

    .cover{
      display:grid; align-items:center; grid-template-columns: 1.2fr 1fr; gap:24px; margin-top:18px
    }
    @media (max-width:900px){ .cover{grid-template-columns:1fr} }
    .hero{
      background: linear-gradient(135deg, rgba(13,110,253,.08) 0%, rgba(135,206,235,.25) 100%);
      border:1px solid rgba(13,110,253,.15);
    }

    .pill{display:inline-block; padding:6px 10px; border-radius:999px; background: rgba(13,110,253,.12); color:var(--primary); font-weight:700; font-size:12px; letter-spacing:.4px}

    .hidden{display:none !important}

    .input, select, textarea{width:100%; padding:12px 14px; border-radius:12px; border:1px solid #e5e7eb; outline:none}
    .input:focus, select:focus, textarea:focus{border-color: var(--primary)}
    label{font-size:13px; color:var(--muted); margin-bottom:6px; display:block}
    .row{display:grid; grid-template-columns:1fr 1fr; gap:12px}
    @media (max-width:700px){ .row{grid-template-columns: 1fr} }

    .quiz-item{border:1px solid #eef2f7; border-radius:12px; padding:16px; margin-bottom:14px}
    .quiz-item h4{margin:0 0 8px}
    .options{display:grid; gap:8px; margin-top:10px}
    .option{display:flex; align-items:center; gap:10px; padding:10px; border:1px dashed #e5e7eb; border-radius:12px; transition: border .2s ease, background .2s ease}
    .option.locked{opacity:.65}

    .notice{padding:10px 12px; border-radius:12px; margin-top:10px; font-size:14px}
    .notice.success{background: #e9fbe7; color:#14532d; border:1px solid #bbf7d0}
    .notice.error{background: #ffecec; color:#7f1d1d; border:1px solid #fecaca}

    .timer{font-variant-numeric: tabular-nums; font-weight:800; letter-spacing:1px}

    table{width:100%; border-collapse: collapse}
    th, td{padding:10px 8px; border-bottom:1px solid #eef2f7; text-align:left; font-size:14px}
    th{background:#f8fafc}
    tr:hover{background:#f9fbff}

    .footer{ text-align:center; color:#6b7280; font-size:13px; margin-top:18px }
    .mt-8{margin-top:24px}
    .center{display:flex; align-items:center; justify-content:center}
  </style>
</head>
<body>
  <div class="app">
    <div class="navbar">
      <div class="brand">
        <div class="logo">UI</div>
        <div>
          <h1>Ujian Online Sistem Komputer Kelas 10 Dari M Iqra Wahid</h1>
        </div>
      </div>
      <div class="nav-actions">
        <button class="btn btn-ghost" id="btnToStudent">Mode Siswa</button>
        <button class="btn btn-primary" id="btnToTeacher">Mode Guru</button>
      </div>
    </div>

    <!-- HERO / INFO -->
    <div class="card hero cover" id="homeCard">
      <div>
        <h2>Selamat datang di "Ujian Online Sistem Komputer Muhamad Iqra Wahid"</h2>
        <p>Silakan pilih mode di kanan atas. Mode siswa memulai pengerjaan dengan waktu <b>60 menit</b>. Mode guru dilindungi sandi untuk melihat <b>daftar nilai</b> dan <b>detail jawaban</b>
        <ul>
          <li>Skor: benar = 1, salah = 0</li>
          <li>Nilai akhir = total benar 10</li>
        </ul>
      </div>
      <div class="center">
        <img alt="ilustrasi belajar" src="https://images.unsplash.com/photo-1513258496099-48168024aec0?q=80&w=1200&auto=format&fit=crop" style="width:100%; border-radius:16px; box-shadow:var(--shadow); max-height:280px; object-fit:cover" />
      </div>
    </div>

    <!-- MODE SISWA: LOGIN -->
    <div class="card hidden" id="studentLogin">
      <h2>Login Siswa</h2>
      <p>Pilih nama Anda untuk memulai ujian. Waktu akan dihitung mundur <b>60:00</b> setelah login berhasil.</p>
      <div class="row">
        <div>
          <label for="studentName">Nama Siswa</label>
          <select id="studentName" class="input">
            <option value="">-- Pilih Nama --</option>
            <option>Andi Titiek Putri Ahari</option>
            <option>Putri Abuleke</option>
            <option>Titiek</option>
            <option>Titiek ashari</option>
          </select>
        </div>
      </div>
      <div class="mt-8">
        <button class="btn btn-primary" id="startExam">Mulai Ujian</button>
        <button class="btn btn-ghost" id="studentBack">Kembali</button>
      </div>
    </div>

    <!-- MODE SISWA: UJIAN -->
    <div class="card hidden" id="studentExam">
      <div style="display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap">
        <h2>Ujian Online: Sistem Komputer</h2>
        <div>
          <span>Nama: <b id="currentStudent">-</b></span>
          <span style="margin-left:14px">Sisa Waktu: <span class="timer" id="timer">60:00</span></span>
        </div>
      </div>
      <div id="quizContainer" class="mt-8"></div>
      <div style="display:flex; gap:8px; flex-wrap:wrap">
        <button class="btn btn-success" id="finishExam">Selesai & Lihat Nilai</button>
        <button class="btn btn-danger" id="logoutStudent">Logout</button>
      </div>
      <div class="footer">Catatan: Jika jawaban salah, soal langsung terkunci. Jawaban benar tidak ditampilkan.</div>
    </div>

    <!-- MODE SISWA: HASIL -->
    <div class="card hidden" id="studentResult">
      <h2>Hasil Ujian</h2>
      <p>Terima kasih telah mengikuti ujian. Berikut ringkasannya:</p>
      <div class="grid grid-2">
        <div class="card" style="box-shadow:none; border:1px solid #e5e7eb">
          <h3>Identitas</h3>
          <p>Nama: <b id="resName">-</b></p>
          <p>Waktu selesai: <b id="resTime">-</b></p>
        </div>
        <div class="card" style="box-shadow:none; border:1px solid #e5e7eb">
          <h3>Skor</h3>
          <p>Benar: <b id="resCorrect">0</b></p>
          <p>Salah: <b id="resWrong">0</b></p>
          <p>Nilai: <b id="resScore">0</b></p>
        </div>
      </div>
      <div class="mt-8">
        <button class="btn btn-ghost" id="resToHome">Kembali ke Beranda</button>
        <button class="btn btn-danger" id="logoutStudent2">Logout</button>
      </div>
    </div>

    <!-- MODE GURU: LOGIN -->
    <div class="card hidden" id="teacherLogin">
      <h2>Login Guru</h2>
      <p>Masukkan password untuk mengakses daftar nilai dan detail jawaban.</p>
      <div class="row">
        <div>
          <input id="teacherPass" class="input" type="password" placeholder="Masukkan password" />
        </div>
      </div>
      <div class="mt-8">
        <button class="btn btn-primary" id="teacherEnter">Masuk Mode Guru</button>
        <button class="btn btn-ghost" id="teacherBack">Kembali</button>
      </div>
    </div>

    <!-- MODE GURU: DASHBOARD -->
    <div class="card hidden" id="teacherDashboard">
      <div style="display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap">
        <div>
          <h2>Dashboard Guru</h2>
          <div class="subtitle">Daftar nilai real-time dari mode siswa (local).</div>
        </div>
        <div style="display:flex; gap:8px; flex-wrap:wrap">
          <button class="btn btn-print" id="btnPrint">Cetak Daftar Nilai</button>
          <button class="btn btn-danger" id="logoutTeacher">Logout Guru</button>
        </div>
      </div>

      <div class="mt-8">
        <h3>Rekap Nilai Peserta</h3>
        <table id="scoresTable">
          <thead>
            <tr>
              <th>#</th>
              <th>Nama</th>
              <th>Waktu Selesai</th>
              <th>Benar</th>
              <th>Salah</th>
              <th>Nilai</th>
              <th>Detail</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <div id="detailPanel" class="card mt-8 hidden" style="box-shadow:none; border:1px solid #e5e7eb">
        <h3>Detail Jawaban Siswa</h3>
        <div id="detailContent">Pilih tombol "Lihat" pada tabel untuk menampilkan rincian.</div>
      </div>

      <div class="footer">Catatan: Data tersimpan di peramban (localStorage) perangkat ini.</div>
    </div>

    <div class="footer">&copy; 2025 • Ujian Online Sistem Komputer • Desain biru langit</div>
  </div>

  <script>
    /******************** CONFIG & DATA ********************/
    const TEACHER_PASSWORD = 'guru-2025'; // Password mode guru (dituliskan di UI)

    const QUESTIONS = [
      { q: '1. Komponen komputer yang berfungsi untuk mengolah data adalah …', options: ['a. Monitor','b. CPU','c. Keyboard','d. Printer'], answerIndex: 1 },
      { q: '2. Perangkat keras yang termasuk input device adalah …', options: ['a. Mouse','b. Speaker','c. Monitor','d. Proyektor'], answerIndex: 0 },
      { q: '3. Sistem komputer terdiri atas tiga komponen utama, yaitu …', options: ['a. Hardware, Software, Peopleware','b. Input, Output, Storage','c. RAM, ROM, CPU','d. Internet, Jaringan, User'], answerIndex: 0 },
      { q: '4. Sistem operasi pada komputer berfungsi untuk …', options: ['a. Mengatur jalannya perangkat keras dan perangkat lunak','b. Menampilkan gambar di monitor','c. Memperbesar kapasitas penyimpanan','d. Mempercepat kecepatan internet'], answerIndex: 0 },
      { q: '5. Perangkat yang digunakan untuk menyimpan data secara permanen adalah …', options: ['a. RAM','b. Harddisk','c. Cache','d. Register'], answerIndex: 1 },
      { q: '6. Orang yang mengoperasikan komputer disebut …', options: ['a. Programmer','b. Peopleware','c. Operator/User','d. Administrator'], answerIndex: 2 },
      { q: '7. Perangkat output yang digunakan untuk mencetak dokumen adalah …', options: ['a. Monitor','b. Proyektor','c. Printer','d. Speaker'], answerIndex: 2 },
      { q: '8. Fungsi RAM pada komputer adalah …', options: ['a. Menyimpan data sementara saat komputer berjalan','b. Menyimpan data permanen','c. Mengatur booting','d. Menampilkan tampilan grafis'], answerIndex: 0 },
      { q: '9. BIOS pada komputer digunakan untuk …', options: ['a. Menjalankan aplikasi perkantoran','b. Mengatur proses booting awal','c. Menyimpan dokumen penting','d. Menyediakan jaringan internet'], answerIndex: 1 },
      { q: '10. Contoh perangkat penyimpanan eksternal adalah …', options: ['a. CPU','b. Flashdisk','c. Monitor','d. Joystick'], answerIndex: 1 },
    ];

    const EXAM_DURATION_SECONDS = 60 * 60; // 60 menit

    // util localStorage keys
    const LS_ATTEMPTS = 'ujian_attempts_v1';

    /******************** STATE ********************/
    let currentStudent = null;
    let answers = []; // {pickedIndex, correct, locked}
    let timer = null; // interval id
    let timeLeft = EXAM_DURATION_SECONDS;

    /******************** ELEMENTS ********************/
    const el = (id)=> document.getElementById(id);

    const homeCard = el('homeCard');
    const studentLogin = el('studentLogin');
    const studentExam = el('studentExam');
    const studentResult = el('studentResult');
    const teacherLogin = el('teacherLogin');
    const teacherDashboard = el('teacherDashboard');

    // Nav buttons
    el('btnToStudent').onclick = ()=> showOnly(studentLogin);
    el('btnToTeacher').onclick = ()=> showOnly(teacherLogin);

    el('studentBack').onclick = ()=> showOnly(homeCard);
    el('teacherBack').onclick = ()=> showOnly(homeCard);

    // Student login
    el('startExam').onclick = ()=>{
      const name = el('studentName').value.trim();
      if(!name){ alert('Silakan pilih nama terlebih dahulu.'); return; }
      startStudentSession(name);
      showOnly(studentExam);
    };

    // Student actions
    el('finishExam').onclick = finishExam;
    el('logoutStudent').onclick = ()=>{ if(confirm('Yakin logout? Progres ujian saat ini akan hilang.')) resetToHome(); };
    el('logoutStudent2').onclick = ()=> resetToHome();
    el('resToHome').onclick = ()=> showOnly(homeCard);

    // Teacher actions
    el('teacherEnter').onclick = ()=>{
      const pass = el('teacherPass').value;
      if(pass !== TEACHER_PASSWORD){
        alert('Password Anda salah');
        return;
      }
      loadScoresTable();
      showOnly(teacherDashboard);
    };
    el('logoutTeacher').onclick = ()=>{ showOnly(homeCard); };
    el('btnPrint').onclick = ()=> window.print();

    /******************** VIEW HELPERS ********************/
    function showOnly(section){
      [homeCard, studentLogin, studentExam, studentResult, teacherLogin, teacherDashboard].forEach(s=> s.classList.add('hidden'));
      section.classList.remove('hidden');
    }

    function renderQuiz(){
      const container = el('quizContainer');
      container.innerHTML = '';
      QUESTIONS.forEach((item, idx)=>{
        const wrapper = document.createElement('div');
        wrapper.className = 'quiz-item';
        const title = document.createElement('h4');
        title.textContent = item.q;
        const opts = document.createElement('div');
        opts.className = 'options';

        item.options.forEach((optText, oi)=>{
          const opt = document.createElement('label');
          opt.className = 'option';
          const radio = document.createElement('input');
          radio.type = 'radio';
          radio.name = 'q_'+idx;
          radio.value = oi;
          radio.onchange = ()=> handleAnswer(idx, oi, opt);

          const span = document.createElement('span');
          span.textContent = optText;

          opt.appendChild(radio); opt.appendChild(span);
          opts.appendChild(opt);
        });

        const feedback = document.createElement('div');
        feedback.id = 'fb_'+idx;

        wrapper.appendChild(title);
        wrapper.appendChild(opts);
        wrapper.appendChild(feedback);
        container.appendChild(wrapper);
      });
    }

    function handleAnswer(qIndex, pickedIndex, optEl){
      if(answers[qIndex]?.locked){ return; }
      const correct = (pickedIndex === QUESTIONS[qIndex].answerIndex);
      answers[qIndex] = { pickedIndex, correct, locked: true };

      // Lock all options of this question
      const radios = document.getElementsByName('q_'+qIndex);
      radios.forEach?.(r=> r.disabled = true) || Array.from(radios).forEach(r=> r.disabled = true);
      optEl.classList.add('locked');

      // Feedback (tanpa menampilkan jawaban benar)
      const fb = el('fb_'+qIndex);
      if(correct){
        fb.className = 'notice success';
        fb.textContent = 'Yeah, kamu menjawab dengan benar 👍';
      }else{
        fb.className = 'notice error';
        fb.textContent = 'Maaf, kamu belum berhasil, belajar lebih giat lagi ya 💪';
      }
    }

    function startTimer(){
      updateTimerText();
      clearInterval(timer);
      timer = setInterval(()=>{
        timeLeft--; updateTimerText();
        if(timeLeft <= 0){
          clearInterval(timer);
          finishExam(true);
        }
      }, 1000);
    }

    function updateTimerText(){
      const mm = Math.floor(timeLeft/60).toString().padStart(2,'0');
      const ss = (timeLeft%60).toString().padStart(2,'0');
      el('timer').textContent = `${mm}:${ss}`;
    }

    function startStudentSession(name){
      currentStudent = name;
      el('currentStudent').textContent = name;
      answers = Array.from({length: QUESTIONS.length}, ()=> ({pickedIndex:null, correct:false, locked:false}));
      timeLeft = EXAM_DURATION_SECONDS;
      renderQuiz();
      startTimer();
    }

    function finishExam(auto=false){
      // Stop timer
      clearInterval(timer);
      // Tally
      const correctCount = answers.filter(a=> a?.correct).length;
      const wrongCount = QUESTIONS.length - correctCount; // unattempted counted as wrong
      const score = correctCount * 10; // 10 soal => *10

      const record = {
        id: Date.now(),
        name: currentStudent,
        finishedAt: new Date().toLocaleString('id-ID'),
        correctCount,
        wrongCount,
        score,
        detail: answers.map((a,i)=> ({
          nomor: i+1,
          dipilih: (a.pickedIndex!=null) ? QUESTIONS[i].options[a.pickedIndex] : '—',
          benar: !!a.correct
        }))
      };

      saveAttempt(record);

      // Show result to student
      el('resName').textContent = record.name;
      el('resTime').textContent = record.finishedAt;
      el('resCorrect').textContent = record.correctCount;
      el('resWrong').textContent = record.wrongCount;
      el('resScore').textContent = record.score;
      showOnly(studentResult);

      // If teacher dashboard is open, refresh table
      if(!teacherDashboard.classList.contains('hidden')){
        loadScoresTable();
      }
    }

    function resetToHome(){
      clearInterval(timer);
      currentStudent = null;
      answers = [];
      timeLeft = EXAM_DURATION_SECONDS;
      el('studentName').value = '';
      showOnly(homeCard);
    }

    /******************** STORAGE ********************/
    function getAttempts(){
      try{ return JSON.parse(localStorage.getItem(LS_ATTEMPTS)) || []; }catch{ return []; }
    }
    function saveAttempt(attempt){
      const list = getAttempts();
      list.push(attempt);
      localStorage.setItem(LS_ATTEMPTS, JSON.stringify(list));
    }

    /******************** TEACHER DASHBOARD ********************/
    function loadScoresTable(){
      const tbody = document.querySelector('#scoresTable tbody');
      tbody.innerHTML = '';
      const list = getAttempts().slice().reverse(); // latest first

      list.forEach((r, idx)=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${idx+1}</td>
          <td>${escapeHtml(r.name)}</td>
          <td>${escapeHtml(r.finishedAt)}</td>
          <td>${r.correctCount}</td>
          <td>${r.wrongCount}</td>
          <td><b>${r.score}</b></td>
          <td><button class="btn btn-ghost" data-id="${r.id}">Lihat</button></td>
        `;
        tbody.appendChild(tr);
      });

      tbody.querySelectorAll('button[data-id]').forEach(btn=>{
        btn.addEventListener('click', ()=> showDetail(parseInt(btn.getAttribute('data-id'))));
      });
    }

    function showDetail(id){
      const list = getAttempts();
      const rec = list.find(x=> x.id === id);
      if(!rec) return;

      const container = el('detailContent');
      const rows = rec.detail.map(d=>{
        return `<tr>
          <td>${d.nomor}</td>
          <td>${escapeHtml(d.dipilih)}</td>
          <td>${d.benar ? '✔️' : '❌'}</td>
        </tr>`;
      }).join('');

      container.innerHTML = `
        <p><b>Nama:</b> ${escapeHtml(rec.name)} &nbsp; | &nbsp; <b>Selesai:</b> ${escapeHtml(rec.finishedAt)}</p>
        <p><b>Ringkas:</b> Benar ${rec.correctCount}, Salah ${rec.wrongCount}, Nilai ${rec.score}</p>
        <div class="mt-8">
          <table>
            <thead><tr><th>No</th><th>Jawaban Dipilih</th><th>Benar?</th></tr></thead>
            <tbody>${rows}</tbody>
          </table>
        </div>
      `;
      el('detailPanel').classList.remove('hidden');
    }

    function escapeHtml(str){
      return String(str).replace(/[&<>"]+/g, s=> ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[s]));
    }

    // Default view
    showOnly(homeCard);
  </script>
</body>
</html>
